<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>DateQuery.java</title>



<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="KEYWORDS" content="JBuilderHtml"></head><body style="background-color: rgb(255, 255, 255);">
<table bgcolor="#c0c0c0" cellpadding="5" cellspacing="0" cols="1" width="100%">
<tbody>
<tr>
<td>
<center> <font color="#000000" face="Arial,Helvetica"> DateQuery.java</font> </center>
</td>
</tr>
</tbody>
</table>
<pre><font color="#000080"><b>import</b></font><font color="#000000"> java</font><font color="#000000">.</font><font color="#000000">sql</font><font color="#000000">.*;</font><font color="#000000"><br></font><font color="#000080"><b>import</b></font><font color="#000000"> java</font><font color="#000000">.</font><font color="#000000">util</font><font color="#000000">.</font><font color="#000000">Calendar</font><font color="#000000">;</font><font color="#000000"><br></font><font color="#000080"><b>public</b></font><font color="#000000"> </font><font color="#000080"><b>class</b></font><font color="#000000"> DateQuery </font><font color="#000000">{</font><font color="#000000"><br></font><font color="#000080"><b>static</b></font><font color="#000000"> </font><font color="#000080"><b>final</b></font><font color="#000000"> String CONN_URL </font><font color="#000000">=</font><font color="#000000"> </font><font color="#0000ff">"</font><font><font color="#0000ff">jdbc:oracle:thin:@oracle1.ensimag.fr:1521:oracle1</font></font><font color="#0000ff">"</font><font color="#000000">;</font><font color="#000000"><br></font><font color="#000080"><b>static</b></font><font color="#000000"> </font><font color="#000080"><b>final</b></font><font color="#000000"> String USER </font><font color="#000000">=</font><font color="#000000"> </font><font color="#0000ff">"scott"</font><font color="#000000">;</font><font color="#000000"><br></font><font color="#000080"><b>static</b></font><font color="#000000"> </font><font color="#000080"><b>final</b></font><font color="#000000"> String PASSWD </font><font color="#000000">=</font><font color="#000000"> </font><font color="#0000ff">"tiger"</font><font color="#000000">;</font><font color="#000000"><br></font><font color="#000080"><b>static</b></font><font color="#000000"> </font><font color="#000080"><b>final</b></font><font color="#000000"> String PRE_STMT1 </font><font color="#000000">=</font><font color="#000000"><br></font><font color="#0000ff">"select min(hiredate),max(hiredate) from emp"</font><font color="#000000">;</font><font color="#000000"><br></font><font color="#000080"><b>static</b></font><font color="#000000"> </font><font color="#000080"><b>final</b></font><font color="#000000"> String PRE_STMT2 </font><font color="#000000">=</font><font color="#000000"><br></font><font color="#0000ff">"select ename,hiredate from emp where to_char(hiredate,'DD-MM-YY') = ?"</font><font color="#000000">;</font><font color="#000000"><br></font><font color="#000080"><b>static</b></font><font color="#000000"> </font><font color="#000080"><b>final</b></font><font color="#000000"> String PRE_STMT3 </font><font color="#000000">=</font><font color="#000000"><br></font><font color="#0000ff">"select ename,hiredate from emp where hiredate &gt; ?"</font><font color="#000000">;</font><font color="#000000"><br></font><font color="#000080"><b>public</b></font><font color="#000000"> DateQuery</font><font color="#000000">()</font><font color="#000000"> </font><font color="#000000">{</font><font color="#000000"><br></font><font color="#000080"><b>try</b></font><font color="#000000"> </font><font color="#000000">{</font><font color="#000000"><br></font><font color="#008000">// Enregistrement du driver Oracle</font><font color="#000000"><br>System</font><font color="#000000">.</font><font color="#000000">out</font><font color="#000000">.</font><font color="#000000">print</font><font color="#000000">(</font><font color="#0000ff">"Loading Oracle driver... "</font><font color="#000000">);</font><font color="#000000"> <br> DriverManager</font><font color="#000000">.</font><font color="#000000">registerDriver</font><font color="#000000">(</font><font color="#000080"><b>new</b></font><font color="#000000"> oracle</font><font color="#000000">.</font><font color="#000000">jdbc</font><font color="#000000">.</font><font color="#000000">driver</font><font color="#000000">.</font><font color="#000000">OracleDriver</font><font color="#000000">());</font><font color="#000000"><br>System</font><font color="#000000">.</font><font color="#000000">out</font><font color="#000000">.</font><font color="#000000">println</font><font color="#000000">(</font><font color="#0000ff">"loaded"</font><font color="#000000">);</font><font color="#000000"><br></font><font color="#008000">// Etablissement de la connection</font><font color="#000000"><br>System</font><font color="#000000">.</font><font color="#000000">out</font><font color="#000000">.</font><font color="#000000">print</font><font color="#000000">(</font><font color="#0000ff">"Connecting to the database... "</font><font color="#000000">);</font><font color="#000000"> <br> Connection conn </font><font color="#000000">=</font><font color="#000000"> DriverManager</font><font color="#000000">.</font><font color="#000000">getConnection</font><font color="#000000">(</font><font color="#000000">CONN_URL</font><font color="#000000">,</font><font color="#000000"> USER</font><font color="#000000">,</font><font color="#000000"> PASSWD</font><font color="#000000">);</font><font color="#000000"><br>System</font><font color="#000000">.</font><font color="#000000">out</font><font color="#000000">.</font><font color="#000000">println</font><font color="#000000">(</font><font color="#0000ff">"connected"</font><font color="#000000">);</font><font color="#000000"><br></font><font color="#008000">/* Recherche de la date d'embauche la plus ancienne et<br> * de la plus r�cente dans la table EMP<br> */</font><font color="#000000"><br></font><font color="#008000">// Creation de la requete</font><font color="#000000"><br>PreparedStatement stmt </font><font color="#000000">=</font><font color="#000000"> conn</font><font color="#000000">.</font><font color="#000000">prepareStatement</font><font color="#000000">(</font><font color="#000000">PRE_STMT1</font><font color="#000000">);</font><font color="#000000"><br></font><font color="#008000">// Execution de la requete</font><font color="#000000"><br>ResultSet rset </font><font color="#000000">=</font><font color="#000000"> stmt</font><font color="#000000">.</font><font color="#000000">executeQuery</font><font color="#000000">();</font><font color="#000000"><br></font><font color="#008000">// Affichage du resultat</font><font color="#000000"><br>System</font><font color="#000000">.</font><font color="#000000">out</font><font color="#000000">.</font><font color="#000000">println</font><font color="#000000">(</font><font color="#0000ff">"Results (date d'embauche la plus ancienne et la plus recente :"</font><font color="#000000">);</font><font color="#000000"><br>Date min</font><font color="#000000">,</font><font color="#000000"> max</font><font color="#000000">;</font><font color="#000000"><br></font><font color="#000080"><b>if</b></font><font color="#000000"> </font><font color="#000000">(</font><font color="#000000">rset</font><font color="#000000">.</font><font color="#000000">next</font><font color="#000000">())</font><font color="#000000"> </font><font color="#000000">{</font><font color="#000000"><br>min </font><font color="#000000">=</font><font color="#000000"> rset</font><font color="#000000">.</font><font color="#000000">getDate</font><font color="#000000">(</font><font color="#0000ff">1</font><font color="#000000">);</font><font color="#000000"><br>max </font><font color="#000000">=</font><font color="#000000"> rset</font><font color="#000000">.</font><font color="#000000">getDate</font><font color="#000000">(</font><font color="#0000ff">2</font><font color="#000000">);</font><font color="#000000"><br>System</font><font color="#000000">.</font><font color="#000000">out</font><font color="#000000">.</font><font color="#000000">println</font><font color="#000000">(</font><font color="#0000ff">"min: "</font><font color="#000000"> </font><font color="#000000">+</font><font color="#000000"> min</font><font color="#000000">);</font><font color="#000000"><br>System</font><font color="#000000">.</font><font color="#000000">out</font><font color="#000000">.</font><font color="#000000">println</font><font color="#000000">(</font><font color="#0000ff">"max: "</font><font color="#000000"> </font><font color="#000000">+</font><font color="#000000"> max</font><font color="#000000">);</font><font color="#000000"><br></font><font color="#000000">}</font><font color="#000000"> </font><font color="#000080"><b>else</b></font><font color="#000000"> </font><font color="#000000">{</font><font color="#000000"><br>System</font><font color="#000000">.</font><font color="#000000">out</font><font color="#000000">.</font><font color="#000000">println</font><font color="#000000">(</font><font color="#0000ff">"No element retrieved"</font><font color="#000000">);</font><font color="#000000"><br></font><font color="#000000">}</font><font color="#000000"><br>System</font><font color="#000000">.</font><font color="#000000">out</font><font color="#000000">.</font><font color="#000000">println</font><font color="#000000">();</font><font color="#000000"><br></font><font color="#008000">// Fermeture</font><font color="#000000"><br>rset</font><font color="#000000">.</font><font color="#000000">close</font><font color="#000000">();</font><font color="#000000"><br>stmt</font><font color="#000000">.</font><font color="#000000">close</font><font color="#000000">();</font><font color="#000000"><br></font><font color="#008000">/* Recherche des employ�s embauch�s le 3 d�cembre 1981<br> */</font><font color="#000000"><br></font><font color="#008000">// Creation de la requete</font><font color="#000000"><br>stmt </font><font color="#000000">=</font><font color="#000000"> conn</font><font color="#000000">.</font><font color="#000000">prepareStatement</font><font color="#000000">(</font><font color="#000000">PRE_STMT2</font><font color="#000000">);</font><font color="#000000"><br>stmt</font><font color="#000000">.</font><font color="#000000">setString</font><font color="#000000">(</font><font color="#0000ff">1</font><font color="#000000">,</font><font color="#000000"> </font><font color="#0000ff">"03-12-81"</font><font color="#000000">);</font><font color="#000000"><br></font><font color="#008000">// Execution de la requete</font><font color="#000000"><br>rset </font><font color="#000000">=</font><font color="#000000"> stmt</font><font color="#000000">.</font><font color="#000000">executeQuery</font><font color="#000000">();</font><font color="#000000"><br></font><font color="#008000">// Affichage du resultat</font><font color="#000000"><br>System</font><font color="#000000">.</font><font color="#000000">out</font><font color="#000000">.</font><font color="#000000">println</font><font color="#000000">(</font><font color="#0000ff">"Results:"</font><font color="#000000">);</font><font color="#000000"><br>dumpResultSet</font><font color="#000000">(</font><font color="#000000">rset</font><font color="#000000">);</font><font color="#000000"><br>System</font><font color="#000000">.</font><font color="#000000">out</font><font color="#000000">.</font><font color="#000000">println</font><font color="#000000">(</font><font color="#0000ff">""</font><font color="#000000">);</font><font color="#000000"><br></font><font color="#008000">// Fermeture</font><font color="#000000"><br>rset</font><font color="#000000">.</font><font color="#000000">close</font><font color="#000000">();</font><font color="#000000"><br>stmt</font><font color="#000000">.</font><font color="#000000">close</font><font color="#000000">();</font><font color="#000000"><br></font><font color="#008000">/* Recherche des employ�s embauch�s apr�s le 1er janvier 1982<br> *<br> * Cr�ation de la date du 1er janvier 1982.<br> * On peut directement utiliser new java.sql.Date(82, 0, 1)<br> * cependant Calendar permet de r�aliser des calculs sur les<br> * dates si n�cessaire.<br> * Attention aux conflits entre java.util.Date et<br> * java.sql.Date.<br> */</font><font color="#000000"><br></font><font color="#008000">//Creation d'un objet Calendar </font><font color="#000000"><br>Calendar cal </font><font color="#000000">=</font><font color="#000000"> </font><font color="#000080"><b>new</b></font><font color="#000000"> java</font><font color="#000000">.</font><font color="#000000">util</font><font color="#000000">.</font><font color="#000000">GregorianCalendar</font><font color="#000000">(</font><font color="#0000ff">1982</font><font color="#000000">,</font><font color="#000000"> </font><font color="#0000ff">0</font><font color="#000000">,</font><font color="#000000"> </font><font color="#0000ff">1</font><font color="#000000">);</font><font color="#000000"><br></font><font color="#008000">//Creation d'un objet Date (de java.sql.Date) equivalent</font><font color="#000000"><br></font><font color="#008000">//� notre objet Calendar (on donne a l'objet Date d le meme</font><font color="#000000"><br></font><font color="#008000">//nombre de milisecondes depuis "January 1, 1970, 00:00:00 GMT")</font><font color="#000000"><br></font><font color="#008000">//remarque 1 : cal.getTime() revoie un objet Date (java.util)</font><font color="#000000"><br></font><font color="#008000">//il faut faire cal.getTime().getTime() pour obtenir un long</font><font color="#000000"><br></font><font color="#008000">//correspondand au nombre de milisecondes depuis </font><font color="#000000"><br></font><font color="#008000">//"January 1, 1970, 00:00:00 GMT"</font><font color="#000000"><br></font><font color="#008000">//remarque 2 : il est possible de r�aliser l'op�ration</font><font color="#000000"><br></font><font color="#008000">//inverse, c'est � dire convertir un objet java.sql.Date</font><font color="#000000"><br></font><font color="#008000">//en java.util.Calendar</font><font color="#000000"><br></font><font color="#008000">//remarque 3 : pour savoir les op�rations disponnibles</font><font color="#000000"><br></font><font color="#008000">//sur les objets Calendar et Date (java.sql), voir les</font><font color="#000000"><br></font><font color="#008000">//description de classes et de m�thodes correspondantes</font><font color="#000000"><br></font><font color="#008000">//dans l'API java : </font><font color="#000000"><br></font><font color="#008000">//http://www.javasoft.com/products/jdk/1.1/docs/api/java.util.Calendar.html</font><font color="#000000"><br></font><font color="#008000">//http://www.javasoft.com/products/jdk/1.1/docs/api/java.util.GregorianCalendar.html</font><font color="#000000"><br></font><font color="#008000">//http://www.javasoft.com/products/jdk/1.1/docs/api/java.sql.Date.html</font><font color="#000000"><br>Date d </font><font color="#000000">=</font><font color="#000000"> </font><font color="#000080"><b>new</b></font><font color="#000000"> Date</font><font color="#000000">(</font><font color="#000000">cal</font><font color="#000000">.</font><font color="#000000">getTime</font><font color="#000000">().</font><font color="#000000">getTime</font><font color="#000000">());</font><font color="#000000"><br></font><font color="#008000">// Creation de la requete</font><font color="#000000"><br>stmt </font><font color="#000000">=</font><font color="#000000"> conn</font><font color="#000000">.</font><font color="#000000">prepareStatement</font><font color="#000000">(</font><font color="#000000">PRE_STMT3</font><font color="#000000">);</font><font color="#000000"><br>stmt</font><font color="#000000">.</font><font color="#000000">setDate</font><font color="#000000">(</font><font color="#0000ff">1</font><font color="#000000">,</font><font color="#000000"> d</font><font color="#000000">);</font><font color="#000000"><br></font><font color="#008000">// Execution de la requete</font><font color="#000000"><br>rset </font><font color="#000000">=</font><font color="#000000"> stmt</font><font color="#000000">.</font><font color="#000000">executeQuery</font><font color="#000000">();</font><font color="#000000"><br></font><font color="#008000">// Affichage du resultat</font><font color="#000000"><br>System</font><font color="#000000">.</font><font color="#000000">out</font><font color="#000000">.</font><font color="#000000">println</font><font color="#000000">(</font><font color="#0000ff">"Results:"</font><font color="#000000">);</font><font color="#000000"><br>dumpResultSet</font><font color="#000000">(</font><font color="#000000">rset</font><font color="#000000">);</font><font color="#000000"><br>System</font><font color="#000000">.</font><font color="#000000">out</font><font color="#000000">.</font><font color="#000000">println</font><font color="#000000">(</font><font color="#0000ff">""</font><font color="#000000">);</font><font color="#000000"><br></font><font color="#008000">// Fermeture</font><font color="#000000"><br>rset</font><font color="#000000">.</font><font color="#000000">close</font><font color="#000000">();</font><font color="#000000"><br>stmt</font><font color="#000000">.</font><font color="#000000">close</font><font color="#000000">();</font><font color="#000000"><br>conn</font><font color="#000000">.</font><font color="#000000">close</font><font color="#000000">();</font><font color="#000000"><br></font><font color="#000000">}</font><font color="#000000"> </font><font color="#000080"><b>catch</b></font><font color="#000000"> </font><font color="#000000">(</font><font color="#000000">SQLException e</font><font color="#000000">)</font><font color="#000000"> </font><font color="#000000">{</font><font color="#000000"><br>System</font><font color="#000000">.</font><font color="#000000">err</font><font color="#000000">.</font><font color="#000000">println</font><font color="#000000">(</font><font color="#0000ff">"failed"</font><font color="#000000">);</font><font color="#000000"><br>e</font><font color="#000000">.</font><font color="#000000">printStackTrace</font><font color="#000000">(</font><font color="#000000">System</font><font color="#000000">.</font><font color="#000000">err</font><font color="#000000">);</font><font color="#000000"><br></font><font color="#000000">}</font><font color="#000000"><br></font><font color="#000000">}</font><font color="#000000"><br></font><font color="#000080"><b>private</b></font><font color="#000000"> </font><font color="#000080"><b>void</b></font><font color="#000000"> dumpResultSet</font><font color="#000000">(</font><font color="#000000">ResultSet rset</font><font color="#000000">)</font><font color="#000000"> </font><font color="#000080"><b>throws</b></font><font color="#000000"> SQLException </font><font color="#000000">{</font><font color="#000000"><br>ResultSetMetaData rsetmd </font><font color="#000000">=</font><font color="#000000"> rset</font><font color="#000000">.</font><font color="#000000">getMetaData</font><font color="#000000">();</font><font color="#000000"><br></font><font color="#000080"><b>int</b></font><font color="#000000"> i </font><font color="#000000">=</font><font color="#000000"> rsetmd</font><font color="#000000">.</font><font color="#000000">getColumnCount</font><font color="#000000">();</font><font color="#000000"><br></font><font color="#000080"><b>while</b></font><font color="#000000"> </font><font color="#000000">(</font><font color="#000000">rset</font><font color="#000000">.</font><font color="#000000">next</font><font color="#000000">())</font><font color="#000000"> </font><font color="#000000">{</font><font color="#000000"><br></font><font color="#000080"><b>for</b></font><font color="#000000"> </font><font color="#000000">(</font><font color="#000080"><b>int</b></font><font color="#000000"> j </font><font color="#000000">=</font><font color="#000000"> </font><font color="#0000ff">1</font><font color="#000000">;</font><font color="#000000"> j </font><font color="#000000">&lt;=</font><font color="#000000"> i</font><font color="#000000">;</font><font color="#000000"> j</font><font color="#000000">++)</font><font color="#000000"> </font><font color="#000000">{</font><font color="#000000"><br>System</font><font color="#000000">.</font><font color="#000000">out</font><font color="#000000">.</font><font color="#000000">print</font><font color="#000000">(</font><font color="#000000">rset</font><font color="#000000">.</font><font color="#000000">getString</font><font color="#000000">(</font><font color="#000000">j</font><font color="#000000">)</font><font color="#000000"> </font><font color="#000000">+</font><font color="#000000"> </font><font color="#0000ff">"\t"</font><font color="#000000">);</font><font color="#000000"><br></font><font color="#000000">}</font><font color="#000000"><br>System</font><font color="#000000">.</font><font color="#000000">out</font><font color="#000000">.</font><font color="#000000">println</font><font color="#000000">();</font><font color="#000000"><br></font><font color="#000000">}</font><font color="#000000"><br></font><font color="#000000">}</font><font color="#000000"><br></font><font color="#000080"><b>public</b></font><font color="#000000"> </font><font color="#000080"><b>static</b></font><font color="#000000"> </font><font color="#000080"><b>void</b></font><font color="#000000"> main</font><font color="#000000">(</font><font color="#000000">String args</font><font color="#000000">[])</font><font color="#000000"> </font><font color="#000000">{</font><font color="#000000"><br></font><font color="#000080"><b>new</b></font><font color="#000000"> DateQuery</font><font color="#000000">();</font><font color="#000000"><br></font><font color="#000000">}</font><font color="#000000"><br></font><font color="#000000">}</font><font color="#000000"><br></font>
</pre>
<table bgcolor="#c0c0c0" cellpadding="5" cellspacing="0" cols="1" width="100%">
<tbody>
<tr>
<td>
<center> <font color="#000000" face="Arial,Helvetica"> DateQuery.java</font> </center>
</td>
</tr>
</tbody>
</table>
</body></html>